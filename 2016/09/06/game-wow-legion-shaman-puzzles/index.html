<!DOCTYPE html><html amp><head><meta charset="utf-8"><link href="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/index.html" rel="canonical"><title>Pot Of Code: World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="author" content="Ivan Zaharchenko"><meta name="description" content="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta name="keywords" content="Игры,Games,World of Warcraft,WoW,ВоВ,Legion,Легион,Головоломки,Puzzles,Шаманы,Shamans,Games,WoW,GA,программирование"><meta property="og:type" content="article"><meta property="og:title" content="Pot Of Code: World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta property="og:url" content="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/"><meta property="og:site_name" content="Pot Of Code"><meta property="og:description" content="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta property="og:image" content="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/wow-legion.png"><meta property="og:updated_time" content="2016-09-06T05:18:37.267Z"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Pot Of Code: World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta property="twitter:description" content="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta property="twitter:image" content="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/wow-legion.png"><meta property="twitter:creator" content="@potofcode"><meta property="twitter:site" content="@potofcode"><link rel="publisher" href="3axap4eHko"><meta property="fb:admins" content="1336988095"><meta property="fb:app_id" content="778520525558698"><meta property="vk:title" content="Pot Of Code: World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta property="vk:url" content="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/"><meta property="vk:image" content="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/wow-legion.png"><meta property="vk:description" content="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения"><meta name="google-site-verification" content="HTUTU2276aWkgL6NZ5yLui5u6EvpZyzx36SifjWFPQc"><link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet"><link href="/vendor/bootstrap/css/bootstrap.yeti.min.css" rel="stylesheet"><link href="/css/style.css" rel="stylesheet"></head><body><nav class="navbar navbar-default navbar-fixed-top shadow-4dp"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand"><h1>Pot Of Code</h1></a></div><div id="navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/categories/статьи/">Статьи</a></li><li><a href="/categories/уроки/">Уроки</a></li><li><a href="/categories/игры/">Игры</a></li><li><a href="/categories/путешествия/">Путешествия</a></li><li><a href="/about">Обо мне</a></li></ul></div></div></nav><main class="row"><div class="container"><div class="col-lg-8 col-md-8 col-sm-12"><div class="shadow-4dp content"><img src="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/wow-legion.png" alt="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения" title="World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения" class="post-image"/><h2 class="post-title">World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения</h2><div class="post-header"><span><i class="fa fa-calendar"></i><a href="/2016/09/06/game-wow-legion-shaman-puzzles/"><time datetime="2016-09-06T23:17:00.000Z">2016-09-06</time></a></span><span><i class="fa fa-folder"></i><span><a class="article-category-link" href="/categories/игры/">Игры</a></span></span></div><div class="post-content"><p>Ave $USER!</p>
<p>Не так давно, вышло очередное дополнение World of Warcraft Legion. Первым делом я принялся прокачивать шамана и был приятно
удивлен получив артифактное оружие в оплоте шаманов. Я забрел к Мастеру головоломок Ло и увидел то, что вы подумали - головоломку.</p>
<p>Передо мной был квадрат из огненных и водных тотемов 5 на 5, после того как кликаешь на тотем, он меняется на противоположный,
например водный на огненный или огненный на водный и так же меняет сверху, снизу, слева и справа. Необходимо сделать так,
что бы все тотемы стали водными. После первого клика я понял, что срочно нужно написать решение для этой головоломки.</p>
<p>Что из этого получилось, читайте далее.
<a id="more"></a>
Задача стояла следующая:
Дана матрица размерности N на M, каждая ячейка матрицы содержит либо 0 либо 1. При изменении значения ячейки матрицы
на противоположное, автоматически меняются на противоположные значения на соседних ячейках сверху, снизу, слева и справа.
Найти последовательность изменений ячеек, что бы матрица состояла только из нулей.</p>
<p>Сначала в голову пришла мысль о переборе всех возможных комбинаций с оптимизацией. Но это все скучно. И я решил написать
генетический алгоритм решения задачи.</p>
<h2 id="Немного-теории"><a href="#Немного-теории" class="headerlink" title="Немного теории"></a>Немного теории</h2><p>Для написания алгритма нам понадобится ввести поняия генов, генотипа, фитнес функции, мутация, поколения и выживания поколения.</p>
<h3 id="Гены"><a href="#Гены" class="headerlink" title="Гены"></a>Гены</h3><p>Геном будем называть значение ячейки матрицы, т.е. это либо 1 либо 0</p>
<h3 id="Генотип"><a href="#Генотип" class="headerlink" title="Генотип"></a>Генотип</h3><p>Генотипом будем называть матрицу представленную в виде строки длинной L = N x M, которая будет содержать последовательно
объединенные строки матрицы, каждый символ строки - это ген</p>
<blockquote>
<p><strong>Пример</strong>
Для матрицы
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">[</div><div class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</div><div class="line">    [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],</div><div class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</div><div class="line">    [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],</div><div class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>Генотипом будет строка <code>0000011111000001111100000</code>, где L = 25</p>
</blockquote>
<h3 id="Фитнесс-функция"><a href="#Фитнесс-функция" class="headerlink" title="Фитнесс функция"></a>Фитнесс функция</h3><p>Фитнесс функцией (Функцией приспособленности) назовем функцию, которая возвращает число от 0 до 1,
чем ближе значение к 1 тем лучше преспособленность индивида. Остается вопрос, что же считать приспособленностью индивида.
Для простоты можем обойтись количеством нулевых генов в генотипе разделенное на длину генотипа</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fitness</span>(<span class="params">genotype</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> genotype.replace(<span class="regexp">/1/g</span>,<span class="string">''</span>).length / genotype.length;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Мутация"><a href="#Мутация" class="headerlink" title="Мутация"></a>Мутация</h3><p>Изменение одного гена в генотипе индивида. Т.к. по правилам игры меняются 5 ячеек матрицы (целевая и соседние),
то одна мутация будет давать 5 новых индивидов.
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">const</span> DIRECTIONS = [</div><div class="line">    &#123;x: <span class="number">0</span>, y: <span class="number">0</span>&#125;,</div><div class="line">    &#123;x: <span class="number">1</span>, y: <span class="number">0</span>&#125;,</div><div class="line">    &#123;x:<span class="number">-1</span>, y: <span class="number">0</span>&#125;,</div><div class="line">    &#123;x: <span class="number">0</span>, y: <span class="number">1</span>&#125;,</div><div class="line">    &#123;x: <span class="number">0</span>, y:<span class="number">-1</span>&#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mutate</span>(<span class="params">genotype</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> DIRECTIONS.map( direction =&gt; &#123;</div><div class="line">        <span class="keyword">const</span> nextX = x + direction.x;</div><div class="line">        <span class="keyword">const</span> nextY = y + direction.y;</div><div class="line">        <span class="keyword">return</span> genotype.flip(nextX, nextY);</div><div class="line">   &#125; );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Выживание"><a href="#Выживание" class="headerlink" title="Выживание"></a>Выживание</h3><p>Селекция индивидов по приспособленности в результате которой, остается ограниченное число наиболее приспособленных.
В нашем случае мы сортируем всех индивидов по убыванию значения фитнесс функции и оставляем первых N x M x 8</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">const</span> maxGenerationSize = <span class="number">400</span>; <span class="comment">// 5 * 5 * 8</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">surviving</span>(<span class="params">populations</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> populations.sort( (a, b) =&gt; &#123;</div><div class="line">        <span class="keyword">return</span> b.fitness - a.fitness;</div><div class="line">    &#125;).slice(<span class="number">0</span>, maxGenerationSize);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Поколение"><a href="#Поколение" class="headerlink" title="Поколение"></a>Поколение</h3><p>Множество индивидов оставшихся после “Выживания”.
Причем самый первый индивид поколения и будет решением, если его приспособленость равна единице</p>
<h2 id="Еще-немного-теории"><a href="#Еще-немного-теории" class="headerlink" title="Еще немного теории"></a>Еще немного теории</h2><p>Можно заметить, что после мутации очень часто можно получить ранее известный геном либо геном, полученный меньшим количеством
мутаций, но с такой же или лучшей приспособленностью. Что бы такого не происходило, создадим хэш-таблицу геномов, ключом которой
будет сам геном, а значением, массив из ячеек мутаций. В случае если этот геном уже встречался и количество ячеек мутаций
не превосходит уже встречавшейся, создаем из него покаление.</p>
<p>Также легко заметить, что мы меняем на всем поле либо 3 либо 5 ячеек, т.е. фитнесс функция возвращает 1 только после значений
<code>L - 3</code> и <code>L - 5</code>. Для них, можно возращать значения фтнесс функции <code>0.999</code>, что бы увеличить их приспособленность</p>
<blockquote>
<p><strong>Пример</strong>
Для марицы 5x5 значение фитнесс функции 1 будет при наличии всех 25 нулей в геноме, а им предшедствуют только либо 20 нулей либо 22</p>
</blockquote>
<p>Весь цикл поиска решения можно представить в виде следующего кода
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">while</span> ( generation++ &lt; maxGenerationsCount &amp;&amp; populations[0].fitness !== 1 ) &#123;</div><div class="line">    populations = mutating( populations );</div><div class="line">    populations = surviving( populations );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>В итоге получилось такое вот приложение</p>
<a href="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/example.png" target="_blank"><img src="https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/example.png" alt="example.png" title=""></a>
<ul>
<li><a href="https://potofcode.com/code/game-wow-legion-shaman-puzzles" target="_blank">Посмотреть на готовое решние можно здесь</a></li>
<li><a href="https://github.com/potofcode/game-wow-legion-shaman-puzzles" target="_blank">Исходники на GitHub</a>
</li>
</ul>
</div><div class="post-tags"><i class="fa fa-tag"></i><span><a class="tag-link" href="/tags/ga/">GA</a>, <a class="tag-link" href="/tags/games/">Games</a>, <a class="tag-link" href="/tags/wow/">WoW</a></span></div><div class="post-footer"><div class="row"><ul class="post-share col-lg-6 col-md-6 col-sm-6 col-xs-12"><li><a href="https://www.facebook.com/sharer/sharer.php?app_id=778520525558698&amp;u=https%3A%2F%2Fpotofcode.com%2F2016%2F09%2F06%2Fgame-wow-legion-shaman-puzzles%2F&amp;t=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;display=popup&amp;ref=plugin&amp;src=potofcode" target="_share_fb" class="btn socicon socicon-facebook">b</a></li><li><a href="http://vk.com/share.php?url=https%3A%2F%2Fpotofcode.com%2F2016%2F09%2F06%2Fgame-wow-legion-shaman-puzzles%2F&amp;title=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;description=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;image=https://potofcode.com/2016/09/06/game-wow-legion-shaman-puzzles/wow-legion.png" target="_share_vk" class="btn socicon socicon-vkontakte">;</a></li><li><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fpotofcode.com%2F2016%2F09%2F06%2Fgame-wow-legion-shaman-puzzles%2F&amp;title=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;summary=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;source=https://potofcode.com" target="_share_ln" class="btn socicon socicon-linkedin">j</a></li><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fpotofcode.com%2F2016%2F09%2F06%2Fgame-wow-legion-shaman-puzzles%2F&amp;text=World%20of%20Warcraft%20Legion%20%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BB%D0%BE%D0%BC%D0%BA%D0%B8%20%D1%88%D0%B0%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2.%20%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F&amp;via=potofcode&amp;hashtags=potofcode" target="_share_tw" class="btn socicon socicon-twitter">a</a></li><li><a href="https://plus.google.com/share?url=https%3A%2F%2Fpotofcode.com%2F2016%2F09%2F06%2Fgame-wow-legion-shaman-puzzles%2F" target="_share_go" class="btn socicon socicon-google">c</a></li></ul></div></div><div id="disqus_thread"></div></div></div><div class="col-lg-3 col-md-12 col-sm-12 row"><aside class="shadow-4dp content sidebar col-lg-12 col-md-5 col-sm-5 panel panel-primary"><div class="sidebar-title panel-heading">недавние</div><ul class="panel-body no-style"><li><a href="/2016/09/06/game-wow-legion-shaman-puzzles/" class="recent-post-title">World of Warcraft Legion головоломки шаманов. Генетический алгоритм решения</a></li><li><a href="/2016/08/21/hello-world-npm/" class="recent-post-title">Hello World. NPM</a></li><li><a href="/2016/08/19/javascript-react-snippets/" class="recent-post-title">React Snippets компоненты If, EventListener, Composer, Sequencer</a></li><li><a href="/2016/08/15/learn-programming-intro-numeral-systems/" class="recent-post-title">Введение в программирование. Система счисления, биты и байты</a></li><li><a href="/2016/04/08/article-node-simple-mvc-app/" class="recent-post-title">Простое современное MVC приложение на Node JS</a></li><li><a href="/2016/03/14/learn-node-chakracore/" class="recent-post-title">Собираем NodeJS с движком Chakra от Microsoft</a></li><li><a href="/2016/03/13/hello-world-node-js/" class="recent-post-title">Hello World. Node JS</a></li><li><a href="/2016/03/13/games-build-rust-server/" class="recent-post-title">Настраиваем свой Rust сервер</a></li><li><a href="/2016/03/12/article-build-environment-p1/" class="recent-post-title">Настройка среды разработки. Часть 1</a></li></ul></aside><div class="col-md-2 col-sm-2 visible-md-block visible-sm-block"></div><aside class="content sidebar col-lg-12 col-md-5 col-sm-5"><div class="panel-body"><ins style="display:inline-block;width:120px;height:240px" data-ad-client="ca-pub-3437520002188474" data-ad-slot="8522251540" class="adsbygoogle"></ins><script>(window.adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside><aside class="shadow-4dp content sidebar col-lg-12 col-md-5 col-sm-5 panel panel-primary"><div class="sidebar-title panel-heading">тэги</div><ul class="panel-body no-style"><li><a href="/tags/ga/">[1] GA</a></li><li><a href="/tags/games/">[2] Games</a></li><li><a href="/tags/rust/">[1] Rust</a></li><li><a href="/tags/steam/">[1] Steam</a></li><li><a href="/tags/wow/">[1] WoW</a></li><li><a href="/tags/chakracore/">[1] chakracore</a></li><li><a href="/tags/express/">[1] express</a></li><li><a href="/tags/hello-world/">[2] hello world</a></li><li><a href="/tags/javascript/">[5] javascript</a></li><li><a href="/tags/linux/">[1] linux</a></li><li><a href="/tags/mvc/">[1] mvc</a></li><li><a href="/tags/node-js/">[4] node js</a></li><li><a href="/tags/npm/">[1] npm</a></li><li><a href="/tags/react/">[1] react</a></li><li><a href="/tags/windows/">[1] windows</a></li><li><a href="/tags/программирование/">[4] программирование</a></li><li><a href="/tags/среда-разработки/">[1] среда разработки</a></li></ul></aside><div class="col-md-2 col-sm-2 visible-md-block visible-sm-block"></div><aside class="shadow-4dp content sidebar col-lg-12 col-md-5 col-sm-5 panel panel-primary"><div class="sidebar-title panel-heading">категории</div><ul class="panel-body no-style"><li><a href="/categories/игры/">[2] Игры</a></li><li><a href="/categories/статьи/">[3] Статьи</a></li><li><a href="/categories/уроки/">[4] Уроки</a></li></ul></aside></div></div></main><footer class="footer"><div class="container"><div class="row"><img src="/images/logo-potofcode.svg" width="200" class="footer-column col-lg-3 col-md-6 col-sm-6 col-xs-12"><div class="footer-column col-lg-3 col-md-6 col-sm-6 col-xs-12">&nbsp;</div><div class="footer-column col-lg-3 col-md-6 col-sm-6 col-xs-12">&nbsp;</div><div class="footer-column col-lg-3 col-md-6 col-sm-6 col-xs-12">&nbsp;</div></div></div></footer><script src="/vendor/bootstrap/js/jquery.min.js" async></script><script src="/vendor/bootstrap/js/bootstrap.min.js" async></script><script>(function() {
var d = document, s = d.createElement('script');
s.src = '//potofcode.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-60230177-1', 'auto');
ga('send', 'pageview');</script><script type="text/javascript">(function (d, w, c) {
  (w[c] = w[c] || []).push(function () {
    try {
      w.yaCounter28756646 = new Ya.Metrika({
        id: 28756646,
        clickmap: true,
        trackLinks: true,
        accurateTrackBounce: true,
        webvisor: true,
        trackHash: true
      });
    } catch (e) {
    }
  });

  var n = d.getElementsByTagName('script')[0],
          s = d.createElement('script'),
          f = function () {
            n.parentNode.insertBefore(s, n);
          };
  s.type = 'text/javascript';
  s.async = true;
  s.src = 'https://mc.yandex.ru/metrika/watch.js';

  if (w.opera == '[object Opera]') {
    d.addEventListener('DOMContentLoaded', f, false);
  } else {
    f();
  }
})(document, window, 'yandex_metrika_callbacks');</script></body></html>